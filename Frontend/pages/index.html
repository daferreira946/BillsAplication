<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Financeiro</title>
        <!-- CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    </head>
    <body>
        <header>
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <a class="navbar-brand" href="index.html">Financeiro</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
                </button>               
            </nav>
        </header>
        <main>
            <div id="container">
                <div class="container">
                    <div id="tabela"  class="row">
                        <div class="col-12 mt-3">
                            <table  class="table table-hover table-striped">
                                <thead class="thead-dark">
                                  <tr>
                                    <th style="width: 15%">Data</th>
                                    <th style="width: 40%">Descrição</th>
                                    <th style="width: 15%">Tipo</th>
                                    <th style="width: 15%">Valor</th>
                                    <th style="width: 15%">Opções</th>

                                  </tr>
                                </thead>
                                <tbody  v-for="entrada in entradas">
                                  <tr>
                                    <td>{{reverseString(entrada.date)}}</td>
                                    <td>{{entrada.description}}</td>
                                    <td>{{entrada.type ? "credito":"debito"}}</td>
                                    <td>{{entrada.value}}</td>
                                    <td class="d-flex">
                                        <button class="btn btn-primary mr-1">
                                            Editar
                                        </button>
                                        <button class="btn btn-danger">
                                            Deletar
                                        </button>
                                    </td>
                                  </tr>                                  
                                </tbody>
                            </table>                            
                        </div>
                        <div class="col-12 mt-5">
                            <table class="table table-hover table-bordered">                                
                                <tbody class="thead-dark">
                                  <tr> 
                                    <th>Saldo</th>                                   
                                    <td>{{ saldoTotal() }}</td>
                                  </tr>                                  
                                </tbody>
                            </table>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-primary" type="submit" id="nova_entrada">Nova entrada</button>
                        </div>                           
                        <div id="nova-entrada" class="col-12 mt-5 d-flex justify-content-center">
                            <div class="card" style="width: 40rem;">
                                <div class="card-header text-center text-white bg-dark">
                                    <h1>Nova entrada</h1>    
                                </div>
                                <div class="card-body">
                                    <form>                                    
                                        <div class="form-row d-flex justify-content-between mt-5">
                                            <div class="col">
                                                <label for="data">Data</label>
                                                <input type="date" class="form-control" id="data" required>
                                            </div>
                                            <div class="col">
                                                <label for="valor">Valor</label>
                                                <input type="number" class="form-control" id="valor" required>
                                            </div>
                                        </div>
                                        <div class="mt-5">
                                                <legend class="col-form-label col-sm-2 p-0">Tipo</legend> 
                                                <div class="form-check mt-2">                                                                                    
                                                    <input class="form-check-input" type="radio" name="tipo" id="credito" value="0" required>
                                                    <label class="form-check-label" for="credito">
                                                    Credito
                                                    </label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="tipo" id="debito" value="1">
                                                    <label class="form-check-label" for="debito">
                                                    Debito
                                                    </label>
                                                </div>
                                        </div>
                                        <div class="form-group mt-5">
                                            <label for="descricao">Descricao</label>
                                            <textarea class="form-control" id="descricao" rows="4" required></textarea>
                                        </div>
                                        <div class="row mt-5">
                                            <div class="col-6 text-center">                                            
                                                <button class="btn btn-success ">Salvar</button>
                                            </div>
                                            <div class="col-6 text-center">
                                                <button class="btn btn-danger">Cancelar</button>
                                            </div>                                        
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>                    
            </div>
        </main>
        <footer>            
        </footer>
        <!-- JS -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js" crossorigin="anonymous"></script>

        <script>    
            var tabela = new Vue({
                el: '#tabela',
                data: {
                    entradas:[
                        {"id":1,"date":"2007-11-06","type":"1","description":"Et at voluptas non fuga. Adipisci exercitationem quisquam in modi voluptatem rerum maiores. Quia odio earum rem molestias dolorem cumque saepe. Rerum voluptas soluta ullam sit.","value":-6419,"created_at":"2020-12-07T19:30:02.000000Z","updated_at":"2020-12-07T19:30:02.000000Z"}
                    ]
                },
                methods:{
                    reverseString(str) {
                        return str.split('-').reverse().join('-').replaceAll('-','/');
                    }
                    ,
                    saldoTotal(){
                        var total = 0;
                        this.entradas.forEach(entrada => {
                            total += parseFloat(entrada.value);
                        });

                        return total;
                    }
                },
                created(){
                    axios.get('http://localhost:8000/bills',{
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }})
                    .then(res => this.entradas = res.data)
                    .catch(err => console.log(err));
                }

            });
            var novaEntrada = new Vue({
                el: '#nova-entrada',
                data: {
                    id:'0',
                    date:'',
                    type:'',
                    description:'',
                    value:''
                },
                methods:{
                    //não está pronto
                    novo(){
                        axios.post('http://localhost:8000/bills',{
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }})
                    .then(res => this.entradas = res.data)
                    .catch(err => console.log(err));
                    }
                },
                created(){
                    
                }

            });
        </script>
    </body>
</html>